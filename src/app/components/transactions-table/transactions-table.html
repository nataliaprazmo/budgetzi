<div class="transactions-table-root">
  <app-transactions-table-filters
    [selectedTypeFilter]="selectedTypeFilter"
    [selectedCategoryFilter]="selectedCategoryFilter"
    [availableCategories]="availableCategories"
    (typeFilterChange)="setTypeFilter($event)"
    (categoryFilterChange)="setCategoryFilter($event)"
  />
  <div class="table-container">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef class="hide-xmobile">Type</th>
        <td mat-cell *matCellDef="let transaction" class="hide-xmobile">
          <app-transaction-type-cell [type]="transaction.type" />
        </td>
      </ng-container>

      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Title</th>
        <td mat-cell *matCellDef="let transaction">
          {{ transaction.title }}
        </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef class="hide-tablet">Description</th>
        <td mat-cell *matCellDef="let transaction" class="hide-tablet">
          @if (transaction.description) {
          {{ transaction.description }}
          } @else {
          <em>—</em>
          }
        </td>
      </ng-container>

      <ng-container matColumnDef="category">
        <th mat-header-cell *matHeaderCellDef class="hide-mobile">Category</th>
        <td mat-cell *matCellDef="let transaction" class="hide-mobile">
          @if (transaction.type === 'expense') {
          {{ transaction.category }}
          } @else {
          <em>—</em>
          }
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount</th>
        <td mat-cell *matCellDef="let transaction">
          <app-transaction-amount-cell [amount]="transaction.amount" [type]="transaction.type" />
        </td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="hide-mobile">Date</th>
        <td mat-cell *matCellDef="let transaction" class="hide-mobile">
          {{ transaction.date | date : 'shortDate' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let transaction">
          <app-transaction-actions-cell
            [transactionId]="transaction.id"
            (delete)="onDelete($event)"
          />
        </td>
      </ng-container>

      @let columnsToDisplay = ['title', 'type','description','category','amount','date','actions'];
      <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
      <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay"></tr>
    </table>
  </div>
  <mat-paginator
    [pageSizeOptions]="[5, 10, 25, 50]"
    [pageSize]="10"
    showFirstLastButtons
    aria-label="Select page of transactions"
  >
  </mat-paginator>
</div>
